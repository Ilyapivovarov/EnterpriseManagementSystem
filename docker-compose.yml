version: '3.4'

networks:
  ems-network:
    external: true

services:
  apigateway:
    image: ${DOCKER_REGISTRY-}apigateway
    environment:
      - ASPNETCORE_ENVIRONMENT=Production
    build:
      context: .
      dockerfile: Src/BackEnd/Gateways/ApiGateway/Dockerfile
    networks:
      ems-network:
        ipv4_address: 10.20.10.100
    
  logworkerservice:
    image: ${DOCKER_REGISTRY-}logworkerservice
    environment:
      - ASPNETCORE_ENVIRONMENT=Production
    build:
      context: .
      dockerfile: Src/BackEnd/Workerservices/LogWorkerService/Dockerfile


  identityservice.webapi:
    image: ${DOCKER_REGISTRY-}identityservicewebapi
    environment:
      - ASPNETCORE_ENVIRONMENT=Production
    build:
      context: .
      dockerfile: Src/BackEnd/Services/IdentityService/IdentityService.WebApi/Dockerfile
    networks:
      ems-network:
        ipv4_address: 10.20.10.101


  taskservice.webapi:
    image: ${DOCKER_REGISTRY-}taskservicewebapi
    environment:
      - ASPNETCORE_ENVIRONMENT=Production
    build:
      context: .
      dockerfile: Src/BackEnd/Services/TaskService/TaskService.WebApi/Dockerfile
    networks:
      ems-network:
        ipv4_address: 10.20.10.103

  userservice.webapi:
    image: ${DOCKER_REGISTRY-}userservicewebapi
    environment:
      - ASPNETCORE_ENVIRONMENT=Production
    build:
      context: .
      dockerfile: Src/BackEnd/Services/UserService/UserService.WebApi/Dockerfile
    networks:
      ems-network:
        ipv4_address: 10.20.10.104
